# üí≥ Projeto Cr√©dito API

API e frontend para consulta e visualiza√ß√£o de cr√©ditos constitu√≠dos, utilizando Spring Boot, Angular e PostgreSQL.

---

## üöÄ Pr√©-requisitos

Antes de iniciar, certifique-se de que os seguintes itens est√£o instalados na sua m√°quina:

- [Git](https://git-scm.com/)
- [Docker](https://www.docker.com/) (preferencialmente na vers√£o mais recente)
- [PostgreSQL](https://www.postgresql.org/) instalado localmente.

---

## ‚öôÔ∏è Configura√ß√£o do Banco de Dados

1. **Crie o banco de dados:**

   ```sql
   CREATE DATABASE credito_db;
   ```

2. **Crie a tabela `credito`:**

   ```sql
   CREATE TABLE credito (
       id                 BIGINT GENERATED BY DEFAULT AS IDENTITY,
       numero_credito     VARCHAR(50) NOT NULL,
       numero_nfse        VARCHAR(50) NOT NULL,
       data_constituicao  DATE NOT NULL,
       valor_issqn        DECIMAL(15, 2) NOT NULL,
       tipo_credito       VARCHAR(50) NOT NULL,
       simples_nacional   BOOLEAN NOT NULL,
       aliquota           DECIMAL(5, 2) NOT NULL,
       valor_faturado     DECIMAL(15, 2) NOT NULL,
       valor_deducao      DECIMAL(15, 2) NOT NULL,
       base_calculo       DECIMAL(15, 2) NOT NULL
   );
   ```

3. **Popule a tabela com dados de exemplo:**

   ```sql
   INSERT INTO credito (numero_credito, numero_nfse, data_constituicao, valor_issqn, tipo_credito, simples_nacional, aliquota, valor_faturado, valor_deducao, base_calculo)
   VALUES
   ('123456', '7891011', '2024-02-25', 1500.75, 'ISSQN', true, 5.0, 30000.00, 5000.00, 25000.00),
   ('789012', '7891011', '2024-02-26', 1200.50, 'ISSQN', false, 4.5, 25000.00, 4000.00, 21000.00),
   ('654321', '1122334', '2024-01-15', 800.50, 'Outros', true, 3.5, 20000.00, 3000.00, 17000.00);
   ```

---

## ‚ñ∂Ô∏è Executando o Projeto

1. **Clone o reposit√≥rio:**

   ```bash
   git clone https://github.com/iagoGB/credito-app.git
   cd credito-api
   ```

2. **Verifique se n√£o h√° bloqueios de comunica√ß√£o entre o container e sua m√°quina local (IP/localhost).**

3. **Execute o projeto com Docker Compose:**

   ```bash
   docker-compose up
   ```

4. **Aguarde o projeto subir e acesse o frontend:**

   [http://localhost:4200](http://localhost:4200)

---

## ‚ö†Ô∏è Observa√ß√£o: Substitui√ß√£o de `host.docker.internal`

Caso o seu Docker **n√£o reconhe√ßa o DNS especial** `host.docker.internal` (por exemplo, em ambientes Linux), substitua-o pelo **endere√ßo IP da sua m√°quina local** nos seguintes arquivos:

- `application.properties` (projeto Java)
- `environment.ts` (projeto Angular)
- `docker-compose.yml` (na se√ß√£o `environment` do servi√ßo backend)

### Como descobrir seu IP local:

```bash
# Windows
ipconfig

# Linux/macOS
ip addr show
```

---

## ‚ö†Ô∏è Observa√ß√£o: Vari√°veis de Ambiente do Banco de Dados

Por padr√£o, o projeto assume que o PostgreSQL est√° rodando com as seguintes configura√ß√µes:

- **Porta:** `5432`
- **Usu√°rio:** `postgres`
- **Senha:** `postgres`
- **Nome do banco:** `credito_db`

### üê≥ Ajustando o `docker-compose.yml` (servi√ßo backend)

Se o banco estiver rodando em uma **porta diferente de 5432**, atualize a vari√°vel de ambiente `SPRING_DATASOURCE_URL` no servi√ßo `backend` do `docker-compose.yml` para refletir a nova porta:

```yaml
environment:
  - SPRING_DATASOURCE_URL=jdbc:postgresql://host.docker.internal:<porta_customizada>/credito_db
```

### üê≥ Ajustando o `application.properties` do projeto Java
  
Se o usu√°rio, senha e/ou porta forem **diferentes dos valores padr√£o**, edite as vari√°veis de ambiente `spring.datasource.username`,`spring.datasource.password` e `spring.datasource.url` com seus respectivos valores:

```yaml
spring.datasource.url=jdbc:postgresql://host.docker.internal:<porta_customizada>/credito_db
spring.datasource.username=<seu_usuario_banco>
spring.datasource.password=<sua_senha_banco>
```

Feito com üíô e tor√ßo para que funcione direitinho!
